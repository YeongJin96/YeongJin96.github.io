---
layout: page
title: 수학 정리
description: 
img:
importance: 1
category: work
---

[이항 분포](#이항 분포(binomial distribution))

[푸아송 분포](#푸아송 분포(Poisson distribution))

[베이즈 정리](#베이즈 정리(Bayes' Theorem))

## 이항 분포(binomial distribution)

각 사건에 구체적인 확률이 배정된 상황에서 주어진 횟수만큼 시행(trial)을 거듭할 때 각 사건의 기대 빈도(발생 횟수)를 나타낸다.



발생확률이 $$p$$인 사건이 $$n$$번의 시행 중 $$k$$번 발생활 확률의 수식은 다음과 같다.
$$
\\P(X = k)= {n \choose k}p^k(1-p)^{n-k}
$$

$$
여기서 {n\choose k} =\ _nC_k = \frac{n!}{k!(n-k)!}
$$

사건별 확률이 정의되어 있을 때 주어진 횟수의 시행에서 주어진 개수의 사건이 발생할 확률을 말해준다.
$$
\\n과\:p를\:고정하고\;k를\;0\le k\le n범위에서\:변화시키면 \:각\: k의\:확률을\:얻을\:수\:있다
$$

$$
p=0.3\\n=5\\
$$

$$
P(X=0) = {5\choose 0}(0.3)^0(1-0.3)^{5-0}=0.1681\\
$$

$$
P(X=1) = {5\choose 1}(0.3)^1(1-0.3)^{5-1}=0.3601\\
$$

$$
P(X=2) = {5\choose 2}(0.3)^2(1-0.3)^{5-2}=0.3087\\
$$

$$
P(X=3) = {5\choose 3}(0.3)^3(1-0.3)^{5-3}=0.1323\\
$$

$$
P(X=4) = {5\choose 4}(0.3)^4(1-0.3)^{5-4}=0.0283\\
$$

$$
P(X=5) = {5\choose 5}(0.3)^5(1-0.3)^{5-5}=0.0024\\
$$

이 확률들의 합은 반올림하면 1.0이므로 전체 표본공간에 관한 확률들의 합은 반드시 1.0이어야 한다는 규칙을 만족



**베르누이 분포**는 이항분포의 특수 사례이며, 베르누이 분포에서는 시행은 항상 한번이고 추출되는 값은 0 or 1이다.



## 푸아송 분포(Poisson distribution)

임의의 특정 시행에서 사건이 발생할 확률은 구체적으로 알지 못하고, 일정 구간에서 사건의 평균 발생 횟수만 알고 있는 경우 사건이 발생한 횟수가 평균적으로 λ라고 할 때, 그 구간에서 사건이  *k*번 발생할 확률은 다음과 같다.

$$\lambda=np$$라고 하면, $$p=\frac{\lambda}{n}$$이므로


$$
\\P(K=k)=\; _nC_kp^k(1-p)^{n-k}\\
$$

$$
=\frac{n(n-1)\cdots(n-k+1)}{k!}(\frac{\lambda}{n})^k(1-\frac{\lambda}{n})^n(1-\frac{\lambda}{n})^{-k}\\
$$

$$
=(\frac{\lambda^k}{k!})\frac{n(n-1)\cdots(n-k+1)}{n^k}(1-\frac{\lambda}{n})^n(1-\frac{\lambda}{n})^{-k}\\
$$

$$
\cdot\\ \cdot\\ \cdot\\
$$

$$
P(k)\; =\; \frac{\lambda^ke^{-\lambda}}{k!}
$$



## 베이즈 정리(Bayes' Theorem)

베이즈 정리의 공식은 다음과 같다.
$$
\\P(H \vert E) = \frac{P(E \vert H)P(H)}{P(E)}
$$
네개 확률 값 중  $$P(H)$$와 $$P(H \vert E)$$는 각각 사전 확률, 사후 확률이라고 부르고, 베이즈 정리는 근본적으로 사전확률과 사후확률 사이의 관계를 나타내는 정리이다.

**사후확률(posterior)** = $$P(H \vert E)$$, $$E$$가 관측되었을때 $$H$$의 확률

**우도(likelihood)** = $$P(E \vert H)$$, 해당 관측치($$E$$)가 나올 확률

**사전확률(prior)** = $$P(H)$$, 관측을 하기 전 이미 알고있는 확률

[타 블로그](http://aischool.ai/%EB%B2%A0%EC%9D%B4%EC%A6%88-%EC%A0%95%EB%A6%AC-%EC%A0%95%EC%9D%98%EC%99%80-%EC%98%88%EC%8B%9C/)에 좋은 예시를 가지고 왔다.

*일반 여성의 유방암의 발병률은 0.1%라고 합니다. 유방암 검사는 실제 유방암에 걸린 사람의 99%에 대해서 양성반응을 나타내고, 건강한 사람에 대해서는 2%만이 양성반응을 보입니다. 이때 어떤 사람의 검사 결과가 양성 반응을 보였다면 이 사람이 실제로 유방암에 걸렸을 확률은 얼마일까요?*

즉 검사결과가 양성일 때, 이 사람이 실제로 유방암에 걸렸을 사후확률$$p(H \vert E)$$를 구하는 문제이다.

**사전 확률**$$p(H)$$는 유방암 발병률인 **0.001**(0.1%)

**우도** $$p(E \vert H)$$는 유방암 환자에 대한 양성반응 확률인 **0.99**(99%)

**사전 확률** $$p(E)$$은 유방암 환자에 대한 양성반응 $$p(E \vert H)p(H)$$ + 건강한 사람에 대한 양성반응$$p(E \vert H^c)p(H^c)$$인 **0.020079**이다.
$$
\\p(E) = p(E \vert H)p(H)\:+\:p(E \vert H^c)p(H^c)
$$

$$
=\:0.99*0.001\:+\:0.02*0.999
$$

$$
=\:0.020079
$$

위에서 구한 사전확률, 우도를 베이즈 정리에 대입해서 H의 사후확률$$p(H \vert E)$$를 구하면
$$
p(H \vert E)=\frac{p(E \vert H)p(H)}{p(E)}
$$

$$
= \frac{0.99*0.001}{0.020079}
$$

$$
= \frac{0.00099}{0.020079}
$$

$$
=0.049
$$

유방암 양성판정을 받았을 경우, 실제 유방암에 걸렸을 확률은 4.9%이다.

만약 유방암 양성판정을 받아 다시한번 유방암검사를 하고, 또 양성이 나왔을 경우 실제 유방암에 걸렸을 확률은 다음과 같다.

**사전 확률**$$p(H)$$는 이전 검사의 사후 확률인 **0.049**

**우도**는 실제 유방암 환자에 대한 양성 반응 확률인 **0.99**

**사전 확률**$$p(E)$$는 $$p(E \vert H)p(H)$$와 건강한 사람이지만 양성반응이 나온 확률$$p(E \vert H^c)p(H^c)$$의 합이므로 **0.06753**
$$
\\p(E) = p(E \vert H)p(H)\:+\:p(E \vert H^c)p(H^c)
$$

$$
= 0.99*0.049\:+\:0.02*0.951
$$

$$
= 0.06753
$$

아까처럼 구해진 사전확률, 우도를 베이즈 정리에 대입하면 다음과 같은 식이 성립된다.
$$
\\p(H \vert E) = \frac{p(E \vert H)p(H)}{p(E)}
$$

$$
= \frac{0.99*0.049}{0.06753}
$$

$$
= \frac{0.04851}{0.06753}
$$

$$
=0.718
$$

두번의 검사결과 모두 유방암 양성 판정을 받았을때, 실제 유방암에 걸렸을 확률은 0.718(71.8%)이다.

## Reference

딥러닝을 위한 수학 - 로널드 크노이젤

공돌이의 수학정리노트(https://angeloyeo.github.io/)
